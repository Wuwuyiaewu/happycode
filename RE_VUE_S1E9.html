<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="./js/vue.js"></script>
    <title>RE_vue_S1E9</title>
    <style>
        html,
        body {
            display: flex;
            justify-content: center;
            height: 100%;
            align-items: center;
        }
    </style>
</head>

<body>
    <div id="app">
        <component-display :c_list="component_filter"></component-display>
        <component-input @post-input="receive_input"></component-input>
        <component-select @send-change="receive_change"></component-select>
    </div>

    <script>
        Vue.component('component-input', {
            data: function() {
                return {
                    input_text: "",
                }
            },
            template: `<div>
            <input type="text" v-model="input_text" @keyup.enter="send">
            </div>`,
            computed: {},
            watch: {},
            methods: {
                send(value) {
                    this.$emit('post-input', value.target.value)
                }
            }
        });
        Vue.component('component-select', {
            data: function() {
                return {
                    button: [{
                        text: "未完成",
                        value: "undone"
                    }, {
                        text: "完成",
                        value: "done"
                    }, {
                        text: "全部",
                        value: "all"
                    }]
                }
            },
            template: `<div>
                <button v-for="item of button" :key="item.value" @click="change(item.value)">{{item.text}}</button></div>`,
            computed: {},
            watch: {},
            methods: {
                change(val) {
                    this.$emit('send-change', val)
                }
            }
        });
        Vue.component('component-display', {
            props: ['c_list'],
            data: function() {
                return {
                    input_text: ""
                }
            },
            template: `<div>
                    <ul>
                        <template>
                            <li v-for="item of c_list" :key="item.time">{{item.content}} 
                            <input type="checkbox" v-model="item.status">
                            <button @click="">完成</button>
                            <button @click=cancle>取消</button>
                            </li>    
                        </template>
                        <template>
                            <li v-for="item of c_list" :key="item.time">{{item.content}} 
                            <input type="checkbox" v-model="item.status">
                            <button @click="editvalue(item.content)">修改</button>
                            <button @click=cancle>刪除</button>
                            </li>    
                        </template>
                        
                        </ul>
                </div>`,
            computed: {},
            watch: {},
            methods: {
                editvalue(val) {
                    this.input_text = val
                    this.emit()
                },
                cancle() {

                }
            }
        });
        (function VueInit() {
            var vm = new Vue({
                el: "#app",
                data: {
                    list: [],
                    show: 'all',
                },
                methods: {
                    receive_change(val) {
                        this.show = val
                    },
                    receive_input(value) {
                        let item = {
                            content: value,
                            status: true,
                            time: new Date().getTime()
                        }
                        this.list.push(item)
                    }
                },
                computed: {
                    component_filter() {
                        if (this.show === 'undone') {
                            return this.list.filter(el => {
                                return el.status === false
                            })
                        } else if (this.show === 'done') {
                            return this.list.filter(el => {
                                return el.status === true
                            })
                        } else {
                            return this.list
                        }
                    }
                },
                watch: {},
                mounted() {},
                created() {},
                destroyed() {}
            })
        })()
    </script>

</body>

</html>